function throttle(t,a,e){var n=null,o=new Date;return function(){var i=this,r=arguments,c=new Date;clearTimeout(n),c-o>=e?(t.apply(i,r),o=c):n=setTimeout(function(){t.apply(i,r)},a)}}function concatFunc(t,a){if("object"===(typeof a).toLowerCase()){var e="";Array.isArray(a)?a.forEach(function(a){concatFunc(t,a)}):(t.push(a),e=Object.keys(a),e.forEach(function(e){concatFunc(t,a[e])}))}}function getMapObj(t){var a=Object.keys(t),e={};return a.forEach(function(a){[].concat(t[a]).forEach(function(t){if("undefined"!=typeof e[t])throw new Error('The rulesObject has some values repeated,such as "'+t+'"');e[t]=a})}),e}function replaceObjectKeys(t,a){if(a&&Object.keys(a).length&&"string"!=typeof t&&null!==t){var e=getMapObj(a),n=[];concatFunc(n,t),n.forEach(function(t){var a=Object.keys(t);a.forEach(function(a){"undefined"!=typeof e[a]&&(t[e[a]]=t[a],delete t[a])})})}}function ajaxReq(t){return t=$.extend({dataType:"JSON",data:{}},t),t.url=APIHOST+t.url,t.data.operator=$(".record-user-name").text(),$.ajax(t).then(function(t){if(1==t.code){try{t.data=JSON.parse(t.data)}catch(a){t.data=t.data}return t}return void alert(t.msg)}).fail(function(t){console.log(t),alert(localeI18n.errorTips)})}function parseTmpl(t){return t.id?template(t.id,t.data||[]):t.tmpl?template.compile(t.tmpl)(t.data||{}):void 0}function initPager(t){var a=t.form;t.page.pagination({dataSource:new Array(Number(t.totalCount)),pageSize:t.pageSize||10,showGoInput:!0,showGoButton:!0,pageNumber:t.pageNum||1,afterPageOnClick:function(t,e){showPage(a.data().pageParam,{pageNum:e})},afterPreviousOnClick:function(t,e){showPage(a.data().pageParam,{pageNum:e})},afterNextOnClick:function(t,e){showPage(a.data().pageParam,{pageNum:e})},afterGoButtonOnClick:function(t,e){Number($(".paginationjs-page").last().text())>=Number(e)&&showPage(a.data().pageParam,{pageNum:e})},callback:function(){}})}function initModal(t,a){a=$.extend({show:function(){},hidden:function(){}},a),t.appendTo("body").on({"show.bs.modal":function(t){a.show.call(this,t)},"hidden.bs.modal":function(e){a.hidden.call(this,e),t.remove()}}).modal("show")}function initBoxAssemble(t,a){var e=this;ajaxReq({url:e.getAttribute("data-api"),data:a||{sku:$(e).closest(".modal").data("sku")}}).then(function(a){console.log(a);var n=formatList(a.data),o={};o[t]=n,"showBoxCode"===t&&$('[data-bind="code-category-count"]').text(Object.keys(n).length),setTimeout(function(){$(e).closest(".modal").find(".tab-pane.active .data-container").html(parseTmpl({id:"item-detail-tmpl",data:o}))})})}function formatList(t,a){var e=t,n={};if("showBill"==a){e=t[0],Object.keys(e).forEach(function(t){var a=e[t].barCode;n[a]||(n[a]={qty:e[t].qty,barCode:a,detail:[]}),delete e[t].barCode,delete e[t].qty,$.each(e[t],function(t,e){n[a].detail.push(e)})});var o=[];return Object.keys(n).forEach(function(t){o.push(n[t])}),o}return Object.keys(e).forEach(function(t){var a=e[t].giftBarCode||e[t].itemId;delete e[t].giftBarCode,delete e[t].itemId;var o=n[a]=Array.isArray(n[a])?n[a]:[];$.each(e[t],function(t,a){o.push(a)})}),n}var localeI18n=i18n[$(".header-container").data("localize")],APIHOST=$(".header-container").data("gift")||"http://54.222.139.99";$.ajaxSetup({cache:!1}),$.fn.serializeObject=function(){var t={},a=this.serializeArray();$.each(a,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""});var e=$("input[type=radio],input[type=checkbox]",this);return $.each(e,function(){t.hasOwnProperty(this.name)||(t[this.name]="")}),t},jQuery.validator.addMethod("stringCheck",function(t,a){return this.optional(a)||/^([\w|-]+)$/g.test(t)},localeI18n.stringCheck),jQuery.validator.addMethod("numberCheck",function(t,a){return this.optional(a)||/^([\d]+)$/g.test(t)},localeI18n.numberCheck),$(document).ajaxStart(function(){$(".ajax-loading-backdrop").show()}).ajaxStop(function(){$(".ajax-loading-backdrop").hide()}),template.config("openTag","${"),template.config("closeTag","}"),$.fn.datepicker&&$(".input-daterange").datepicker({format:"yyyy-mm-dd",language:"zh-CN",autoclose:!0}),$('[data-toggle="tab"]').on("shown.bs.tab",function(){var t=$(this),a=$(t.attr("data-target"));a.find("form.search-form[data-api]").submit()}),$(function(){$(".tab-list-item.active").click()}),$("body").on("click",".modal .modal-submit-btn",function(){$(this).closest(".modal").find(".modal-body").find("form:visible").submit()}).on("click","[data-print-url]",function(){setTimeout(function(){open(APIHOST+this.getAttribute("data-print-url"),"_blank")}.bind(this))}),$("body").on("submit","form.search-form[data-api]",function(){var t=this.getAttribute("data-tmpl"),a=(this.getAttribute("data-func"),$(this));return a.data({pageParam:{page:a.closest(".tab-pane").find("#pagination-container"),dataContainer:a.closest(".tab-pane").find(".table-responsive > table .data-container"),id:t,form:a},submitParam:a.serializeObject()}),showPage(a.data().pageParam),!1});var fillInputData=function(){function t(t,a){return $.isArray(a)&&$.each(a,function(a,e){return t.value==e?(t.checked=!0,!1):void 0})}function a(t,a){this.filter(t).each(function(t,n){"undefined"!=typeof a[n.name]&&(e[n.type]?e[n.type]:e.common)(n,a[n.name])})}var e={text:function(t,a){t.value=a},number:function(t,a){e.text(t,a)},common:function(t,a){this.text(t,a)},checkbox:function(a,e){var n="";if(!t(a,e)){try{n=JSON.parse(e)}catch(o){n=e.split(",")}t(a,n)}},radio:function(t,a){t.value==a&&(t.checked=!0)},select:function(t,a){$(t).find('option[value="'+a+'"]').prop("selected",!0)}};return function(t,e){t=$($.makeArray(t));var n=['[type="text"]','[type="number"]','[type="checkbox"]','[type="radio"]',"select"];$.each(n,function(n,o){a.call(t,o,e)})}}(),tipsShow=function(){var t=$('<div class="tipsShow"></div>');return function(a,e,n){""!==a.toString().trim()&&t.text(a).show().appendTo(e).delay(n||2700).fadeOut("300",function(){t.remove()})}}();