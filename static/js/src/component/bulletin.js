var bulletinComponent=Vue.extend({props:["setting"],data:function(){return{extendClass:{bulletin:!0}}},template:'<li class="template" :class="extendClass"  data-field="bulletin" :data-setting="setting | json">\n    <div class="block-img">\n        <div>\n            <img src="/img/static/img/component/bulletin_block.png">\n        </div>\n        <p>公告栏组件</p>\n    </div>\n    <div class="canvas-img" >\n        <img src="/img/static/img/component/bulletin_canvas.png">\n        <i class="close-btn">×</i>\n    </div>\n</li>',methods:{},created:function(){}});Vue.component("bulletin",bulletinComponent);var bulletinFormComponent=Vue.extend({data:function(){return{setting:{},show:!1,urlType:{url:{value:"URL",palceholderVal:"URL"},channel:{value:"频道ID",palceholderVal:"示例:1234"},detail:{value:"SKU",palceholderVal:"示例:CBD492"},brand:{value:"品牌ID",palceholderVal:"示例：123"},category:{value:"前台分类",palceholderVal:"示例:面膜"},"function":{value:"功效",palceholderVal:"示例:补水保湿"},search:{value:"搜索",palceholderVal:"搜索关键词"}},i18n:window.i18n[document.body.getAttribute("data-localize")]}},methods:{addBulletin:function(){var e=this,t=$(event.currentTarget).closest(attrClass),n=uuid();e.setting.data.push({status:"1",position:"",bulletin_title:"",start_time:"",end_time:"",item_action_url:"",item_action_url_type:"",url_type:"URL",url_text:"",id:n}),binChange();var i=setTimeout(function(){e.resetSetting(t),clearTimeout(i)},30)},initDate:function(e,t,n){var i={};t&&"start"==n&&(i.maxDate=t),t&&"end"==n&&(i.minDate=t),$(e.target).datetimepicker({onShow:function(){this.setOptions(i)}})},slideItem:function(e){var t=e.currentTarget;$(t).find(".fa").toggleClass("fa-caret-right"),$(t).siblings(".itemBody").slideToggle()},status:function(e){var t=$("body").data("state"),n=$("body").data("server-time"),i=e.status,a=e.start_time.replace(/-/g,"/"),l=new Date(a).getTime()/1e3,s=e.end_time.replace(/-/g,"/"),o=new Date(s).getTime()/1e3;return 1==t?1==i?l>n?"未开始":o>n?"已上线":"已过期":"已关闭":0==i?"已关闭":"--"},changeUrlType:function(e){var t=e.currentTarget,n=$(t).find("option:selected").data("placeholder");$(t).siblings(".inputWord").attr("placeholder",n);var i=$(t).find("option:selected").data("link_type");$(t).siblings(".inputWord").val("");var a=$(t).siblings(".inputWord").val(),l=convertToAPPLink(i,a);$(t).siblings("[name=item_action_url]").val(l),$(t).siblings("[name=item_action_url_type]").val(i)},changeUrlInput:function(e){var t=e.currentTarget,n=$(t).siblings("select.appLink").find("option:selected").data("link_type"),i=$(t).val(),a=convertToAPPLink(n,i);$(t).siblings("[name=item_action_url]").val(a),$(t).siblings("[name=item_action_url_type]").val(n)},shutBulletin:function(e){for(var t=this,n=$(e.currentTarget).closest(attrClass),i=$(e.currentTarget).closest(".singleItem").find(".uid").val(),a=t.setting.data,l=0;l<a.length;l++)i==a[l].id&&(a[l].status=0);t.setting.data=a;var s=setTimeout(function(){t.resetSetting(n);var i=$("body").data("state");saveData(i,function(e){1==e.code?window.location.href="/app/home/"+e.data.pageId:alert(e.msg)},$(e.currentTarget)),clearTimeout(s)},30)},openBulletin:function(e){for(var t=this,n=$(e.currentTarget).closest(attrClass),i=$(e.currentTarget).closest(".singleItem").find(".uid").val(),a=t.setting.data,l=0;l<a.length;l++)i==a[l].id&&(a[l].status=1);t.setting.data=a;var s=setTimeout(function(){t.resetSetting(n);var i=$("body").data("state");saveData(i,function(e){1==e.code?window.location.href="/app/home/"+e.data.pageId:alert(e.msg)},$(e.currentTarget)),clearTimeout(s)},30)},deleteBulletin:function(e){for(var t=this,n=$(e.currentTarget).closest(attrClass),i=$(e.currentTarget).closest(".singleItem").find(".uid").val(),a=t.setting.data,l=[],s=0;s<a.length;s++)i!=a[s].id&&l.push(a[s]);t.setting.data=l;var o=setTimeout(function(){t.resetSetting(n);var i=$("body").data("state");saveData(i,function(e){1==e.code?window.location.href="/app/home/"+e.data.pageId:alert(e.msg)},$(e.currentTarget)),clearTimeout(o)},30)},resetSetting:function(e){var t=$(e).find("form.commonConf").eq(0).serializeObject(),n=$(e).find(".singleConf form.singleItem"),i=$(n).length,a=[];if(i>0)for(var l=0;i>l;l++)a.push($(n[l]).serializeObject());var s=_.extend(t,{data:a});resetForm(s)},subForm:function(){}},template:'<div class="bulletin-attr attr-form" v-show="show" role="form">\n    <div class="panel-group">\n        <div class="panel panel-default">\n            <div class="panel-heading"><a data-toggle="collapse" data-parent="#bulletin" href="#bulletin">公告栏组件</a>\n            </div>\n            <div id="bulletin" class="panel-collapse collapse">\n                <div class="panel-body">\n                    <form class="commonConf">\n                        <div class="form-group">\n                            <div>背景图片URL(建议750*----)</div>\n                            <img class="thumbnail"  v-if="setting.bg_img" :src="setting.bg_img">\n                            <input class="form-control input-sm bgImg removeSpace" value="${setting.bg_img}" v-model="setting.bg_img" name="bg_img" placeholder="${i18n.bannerBg}"\n                                   type="text">\n                        </div>\n                        <input type="hidden" class="has_change" name="has_change" value="${setting.has_change}">\n                    </form>\n\n                    <div v-if="setting.data && setting.data.length>0" class="bulletinGroup singleConf">\n                        <form  v-for="(i,bulletin) in setting.data" class="bulletinItem singleItem">\n                            <input type="hidden" class="uid" name="id" value="${bulletin.id}">\n                            <a class="itemTitle" @click="slideItem($event)">配置(${bulletin.position},${status(bulletin)}) <i class="fa fa-caret-down"></i></a>\n                            <div class="itemBody">\n                                <div class="form-group">\n                                    <div><em class="red">*</em>排序</div>\n                                    <input class="form-control input-sm position" value="${bulletin.position}" v-model="bulletin.position" name="position" placeholder="${i18n.please_input_number}"\n                                           type="text">\n                                </div>\n                                <div class="form-group">\n                                    <div><em class="red">*</em>消息文字</div>\n                                    <input class="form-control input-sm icon_title" value="${bulletin.bulletin_title}"  name="bulletin_title"\n                                           type="text">\n                                </div>\n                                <div class="form-group">\n                                    <div><em class="red">*</em>开始时间</div>\n                                    <input @mousedown="initDate($event,bulletin.end_time,\'start\')" v-model="bulletin.start_time" class="form-control input-sm startTime" value="${bulletin.start_time}"  name="start_time" placeholder="${i18n.start_time}"\n                                           type="text">\n                                </div>\n                                <div class="form-group">\n                                    <div><em class="red">*</em>结束时间</div>\n                                    <input @mousedown="initDate($event,bulletin.start_time,\'end\')" v-model="bulletin.end_time" class="form-control input-sm endTime" value="${bulletin.end_time}" name="end_time" placeholder="${i18n.end_time}" type="text">\n                                </div>\n                                <!--<div class="form-group">\n                                    <div><em class="red">*</em>活动图片URL(建议750*424)</div>\n                                    <img class="thumbnail" v-if="bulletin.banner_img" :src="bulletin.banner_img">\n                                    <input class="form-control input-sm imgSrc removeSpace" v-model="bulletin.banner_img" value="${bulletin.banner_img}" name="banner_img" placeholder="${i18n.bannerSrc}"\n                                           type="text">\n                                </div>-->\n                                <div class="form-group">\n                                    <div>跳转URL/APP原生页面</div>\n                                    <select class="form-control linkKind appLink" name="url_type" @change="changeUrlType($event)" value="${bulletin.url_type}">\n                                        <template v-for="(k,v) in urlType">\n                                            <option v-if="bulletin.url_type==v.value"\n                                                    data-link_Type ="${k}"\n                                                    data-placeholder="${v.palceholderVal}"\n                                                    selected>\n                                                ${v.value}\n                                            </option>\n                                            <option v-else\n                                                    data-link_Type ="${k}"\n                                                    data-placeholder="${v.palceholderVal}">\n                                                ${v.value}\n                                            </option>\n                                        </template>\n                                    </select>\n                                    <input class="form-control input-sm inputWord" name="url_text" @change="changeUrlInput($event)" value="${bulletin.url_text}" placeholder="URL" type="text">\n                                    <input class="form-control input-sm" name="item_action_url" type="hidden" v-model="bulletin.item_action_url" value="${bulletin.item_action_url}">\n                                    <input class="form-control input-sm" name="item_action_url_type" type="hidden" value="${bulletin.item_action_url_type}">\n                                </div>\n                                <!--<div class="form-group">\n                                    <div><em class="red">*</em>Category ID</div>\n                                    <input class="form-control input-sm position" value="${bulletin.category_id}"  name="category_id" placeholder="${i18n.please_input_number}"\n                                           type="text">\n                                </div>-->\n                                <div class="form-group">\n                                    <div class="ops">\n                                        <a class="btn btn-warning btn-sm shutBulletin" @click="shutBulletin($event)" :class="{\'active\':bulletin.status==1}" type="button">${i18n.shut}\n                                        </a>\n                                        <a class="btn btn-success btn-sm openBulletin" @click="openBulletin($event)" :class="{\'active\':bulletin.status==0}" type="button">${i18n.open}\n                                        </a>\n                                    </div>\n                                    <input class="status" type="hidden" name="status" value="${bulletin.status}">\n                                </div>\n                            </div>\n                            <div class="form-group delIcon">\n                                <div class="ops">\n                                    <a class="btn btn-sm delBanner" @click="deleteBulletin($event)" type="button">×</a>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <a @click="addBulletin($event)" class="addBulletin btn btn-primary">${i18n.add_config} + </a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n',created:function(){console.log()}});Vue.component("bulletin-form",bulletinFormComponent);