var liveComponent=Vue.extend({props:["setting"],data:function(){return{extendClass:{live:!0}}},template:'<li class="template" :class="extendClass" data-field="live" :data-setting="setting | json">\n    <div class="block-img">\n        <div>\n            <img src="/img/static/img/component/live_block.png">\n        </div>\n        <p>直播组件</p>\n    </div>\n    <div class="canvas-img" >\n        <img src="/img/static/img/component/live_canvas.png">\n        <i class="close-btn">×</i>\n    </div>\n</li>',methods:{},created:function(){}});Vue.component("live",liveComponent);var liveFormComponent=Vue.extend({data:function(){return{setting:{},show:!1,i18n:window.i18n[document.body.getAttribute("data-localize")]}},methods:{initDate:function(e,t,i){var n={};t&&"start"==i&&(n.maxDate=t),t&&"end"==i&&(n.minDate=t),$(e.target).datetimepicker({onShow:function(){this.setOptions(n)}})},slideItem:function(e){var t=e.currentTarget;$(t).find(".fa").toggleClass("fa-caret-right"),$(t).siblings(".itemBody").slideToggle()},emptyLive:function(e){var t=this,i=$(e.currentTarget).closest(attrClass),n=$(e.currentTarget).closest(".singleItem");$(n).find("input[name=is_pass]").val("0");var s=setTimeout(function(){t.resetSetting(i),clearTimeout(s)},300)},readLive:function(e){var t=this,i=$(e.currentTarget).closest(attrClass),n=$(e.currentTarget).closest(".singleItem"),s=$(n).find("input[name=liveRoomId]").val();if(s){var a={liveRoomId:s};$.ajax({type:"get",dataType:"json",url:"/api/internal/sas/live/detail",data:a,success:function(e){if(1==e.code){$(n).find("input[name=is_pass]").val("1"),alert("校验成功");var s=setTimeout(function(){t.resetSetting(i),clearTimeout(s)},300)}else{alert("校验失败"),$(n).find("input[name=is_pass]").val("0");var a=setTimeout(function(){t.resetSetting(i),clearTimeout(a)},300)}},error:function(){console.log("出现异常")}})}else{$(n).find("input[name=is_pass]").val("0");var l=setTimeout(function(){t.resetSetting(i),clearTimeout(l)},300)}},resetSetting:function(e){var t=$(e).find("form.commonConf").eq(0).serializeObject(),i=$(e).find(".singleConf form.singleItem"),n=$(i).length,s=[];if(n>0)for(var a=0;n>a;a++)s.push($(i[a]).serializeObject());var l=_.extend(t,{data:s});resetForm(l)},subForm:function(){}},watch:{"setting.data[0].start_time":function(e){this.$nextTick(function(){return e&&this.setting.data[0].end_time&&+new Date(this.setting.data[0].end_time)<+new Date(e)?(alert("开始日期不能晚于结束日期"),void(this.setting.data[0].start_time="")):void 0})},"setting.data[0].end_time":function(e){this.$nextTick(function(){return e&&this.setting.data[0].start_time&&+new Date(this.setting.data[0].start_time)>+new Date(e)?(alert("开始日期不能晚于结束日期"),void(this.setting.data[0].end_time="")):void 0})}},template:'<div class="live-attr attr-form" v-show="show" role="form">\n    <div class="panel-group">\n        <div class="panel panel-default">\n            <div class="panel-heading"><a data-toggle="collapse" data-parent="#live" href="#live">直播组件</a>\n            </div>\n            <div id="live" class="panel-collapse collapse">\n                <div class="panel-body">\n                    <form class="commonConf">\n                        <div class="form-group ">\n                            <div>背景图片URL(建议750*1240)</div>\n                            <img class="thumbnail"  v-if="setting.bg_img" :src="setting.bg_img">\n                            <input class="form-control input-sm bgImg removeSpace" value="${setting.bg_img}" v-model="setting.bg_img" name="bg_img" placeholder="${i18n.bannerBg}"\n                                   type="text">\n                        </div>\n                        <!--<div class="form-group ">\n                            <div><em class="red">*</em>模块title</div>\n                            <input class="form-control input-sm" value="${setting.title}" v-model="setting.title" name="title" type="text">\n                        </div>-->\n                        <input type="hidden" class="has_change" name="has_change" value="${setting.has_change}">\n                    </form>\n\n                    <div v-if="setting.data && setting.data.length>0" class="liveGroup singleConf">\n                        <form  v-for="(i,live) in setting.data" class="liveItem singleItem">\n                            <input type="hidden" class="uid" name="id" value="${live.id}">\n                            <!--<a class="itemTitle" @click="slideItem($event)">直播配置(${live.start_time}-${live.end_time},${status(live)}) <i class="fa fa-caret-down"></i></a>-->\n                            <div class="itemBody">\n                                <div class="form-group">\n                                    <div><em class="red">*</em>房间ID</div>\n                                    <input class="form-control input-sm position" @keydown="emptyLive($event)" value="${live.liveRoomId}" v-model="live.liveRoomId" name="liveRoomId" type="text">\n                                    <a class="btn btn-success btn-sm readLive" @click="readLive($event)" type="button">${i18n.validate}</a>\n                                    <input type="hidden" name="is_pass" value="${live.is_pass}">\n                                </div>\n                                <!--<div class="form-group">\n                                    <div><em class="red">*</em>视频名称</div>\n                                    <input class="form-control input-sm grayInput" value="${live.live_title}" onkeydown="return false" name="live_title" type="text">\n                                </div>\n                                <div class="form-group">\n                                    <div><em class="red">*</em>视频链接</div>\n                                    <input class="form-control input-sm grayInput" value="${live.live_url}" onkeydown="return false"  name="live_url" type="text">\n                                </div>-->\n                                <div class="form-group">\n                                    <div><em class="red">*</em>直播主图</div>\n                                    <input class="form-control input-sm removeSpace" value="${live.live_img}" name="live_img" v-model="live.live_img" type="text" >\n                                    <img class="thumbnail liveImg"  v-show="live.live_img" :src="live.live_img">\n                                </div>\n                                <div class="form-group">\n                                    <div><em class="red">*</em>开始时间</div>\n                                    <input @mousedown="initDate($event,live.end_time,\'start\')" v-model="live.start_time" class="form-control input-sm startTime" value="${live.start_time}"  name="start_time" placeholder="${i18n.start_time}"\n                                           type="text">\n                                </div>\n                                <div class="form-group">\n                                    <div><em class="red">*</em>结束时间</div>\n                                    <input @mousedown="initDate($event,live.start_time,\'end\')" v-model="live.end_time" class="form-control input-sm endTime" value="${live.end_time}" name="end_time" placeholder="${i18n.end_time}" type="text">\n                                </div>\n                                <!--<div class="form-group">\n                                    <div class="ops">\n                                        <a class="btn btn-warning btn-sm shutLive" @click="shutLive($event)" :class="{\'active\':live.status==1}" type="button">${i18n.shut}\n                                        </a>\n                                        <a class="btn btn-success btn-sm openLive" @click="openLive($event)" :class="{\'active\':live.status==0}" type="button">${i18n.open}\n                                        </a>\n                                    </div>\n                                    <input class="status" type="hidden" name="status" value="${live.status}">\n                                </div>-->\n                            </div>\n                            <!--<div class="form-group delIcon">\n                                <div class="ops">\n                                    <a class="btn btn-sm delBanner" @click="deleteLive($event)" type="button">×</a>\n                                </div>\n                            </div>-->\n                        </form>\n                    </div>\n                    <!--<a @click="addLive($event)" class="addLive btn btn-primary">${i18n.add_config} + </a>-->\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n',created:function(){console.log()}});Vue.component("live-form",liveFormComponent);