function formValidator(e,t,a){for(var r=e.field,i=!0,o=0;o<r.length;o++){var n=r[o],m=n.type,l=unRequired[m],s=0;for(var c in n)if("data"!=c){if(!isInArray(c,l.common)){if($.trim(n[c])||s++,"imagetext"==m&&gblen($.trim(n.title))>16)return i=!1,alert(componentName[m]+"组件下编辑有误"),t.removeClass("disable"),$("#imagetext").find("input[name='title']").addClass("err"),$("#imagetext").find("input[name='title']").after('<span class="tip">标题过长</span>'),!1;$("#imagetext").find("input[name='title']").removeClass("err"),$("#imagetext").find(".form-group .tip").remove()}}else for(var u=0;u<n.data.length;u++){var d=n.data[u];for(var v in d)isInArray(v,l.items)||$.trim(d[v])||s++}if(s>0)return i=!1,alert(componentName[m]+"组件下有未填项"),t.removeClass("disable"),!1;var _=[];if("banner"==m||"activity"==m||"bulletin"==m)for(var f=0;f<n.data.length;f++){var p=n.data[f];_.push(p.position)}if(isRepeat(_))return i=!1,alert(componentName[m]+"组件下排序配置重复"),t.removeClass("disable"),!1;var g=0;if("icon"==m)for(var b=0;b<n.data.length;b++){var h=n.data[b];$.trim(h.icon_title)||g++}if(0!=g&&5!=g)return i=!1,alert(componentName[m]+"组件下文字标题未填写完"),t.removeClass("disable"),!1;var y=[];if("discount"==m)for(var C=0;C<n.data.length;C++){var x=n.data[C];y.push(x.discount_time)}if(isRepeat(y))return i=!1,alert(componentName[m]+"组件下时间配置重复"),t.removeClass("disable"),!1;if("video"==m&&lenFor(n.title)>20)return alert(componentName[m]+"组件下title字段不能超过20个字节"),t.removeClass("disable"),!1;var N;if("video"==m&&n.data.length>0){for(var A=[],I=[],w=0;w<n.data.length;w++)A.push(n.data[w].start_time),I.push(n.data[w].end_time);N=compareDate(A,I)}if("video"==m&&!N)return alert(componentName[m]+"组件下时间重复"),t.removeClass("disable"),!1;if("live"==m&&0==n.data[0].is_pass)return alert(componentName[m]+"组件下房间ID未校验或校验未通过"),t.removeClass("disable"),!1}i?a&&a():t.removeClass("disable")}function gblen(e){for(var t=0,a=0;a<e.length;a++)e.charCodeAt(a)>127||94==e.charCodeAt(a)?t+=2:t++;return t}function compareDate(e,t){e=e.sort(),t=t.sort();for(var a=0,r=1;r<e.length;r++)e[r]<=t[r-1]&&a++;return a>0?!1:!0}var componentName={banner:"banner",icon:"首页ICON",bulletin:"公告栏",special:"特色栏目",discount:"今日特价",activity:"活动",groupon:"拼团",favor:"猜你喜欢",favorcom:"猜你喜欢2",separate:"分割线",brandcate:"分类商品",video:"视频",live:"直播",imagetext:"图文组件",flashale:"秒杀",newcomer:"新人价"},unRequired={banner:{common:["bg_img"],items:[]},icon:{common:["bg_img"],items:["icon_title"]},bulletin:{common:["bg_img"],items:["url_type","url_text","item_action_url","item_action_url_type"]},special:{common:[],items:[]},discount:{common:[],items:["url_type","url_text","item_action_url","item_action_url_type"]},activity:{common:[],items:[]},groupon:{common:["url_type","url_text","action_url","action_url_type"],items:[]},newcomer:{common:["url_type","url_text","action_url","action_url_type"],items:[]},favor:{common:[],items:["show_num"]},favorcom:{common:[],items:[]},separate:{common:["isNew"],items:["space_height","space_color","url_type","url_text","item_action_url","item_action_url_type"]},brandcate:{common:[],items:["cate_name","cate_img","category_id"]},video:{common:["bg_img"],items:[]},live:{common:["bg_img"],items:[]},flashsale:{common:[],items:[]},imagetext:{common:[],items:[]}},isInArray=function(e,t){for(var a=0;a<t.length;a++)if(e==t[a])return!0;return!1},lenFor=function(e){var t=0,a=e.length;if(e){for(var r=0;a>r;r++)e.charCodeAt(r)>255?t+=2:t++;return t}return 0};