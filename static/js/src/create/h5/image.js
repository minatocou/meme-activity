$(".link").each(function(){$(this).resizable({containment:$(this).closest("li")}).draggable({containment:$(this).closest("li")})}),$("[name=imgFromTime]").datetimepicker(),$("[name=imgToTime]").datetimepicker({onShow:function(){this.setOptions({minDate:$("[name=imgFromTime]").val()?$("[name=imgFromTime]").val():!1})}}),$("#addLink").click(function(){var i=$(CANVAS_PANEL).find(".cur"),a=$('<div class="link"><span class="link-url">'+$("#linkUrl").val()+'</span><i class="close-link-btn">×</i></div>').appendTo(i);a.resizable({containment:i}).draggable({containment:i})}),$("#addPop").click(function(){var i=$(CANVAS_PANEL).find(".cur");if(""===$("#popupImgUrl").val().trim())alert("弹窗图片url不能为空");else if(""===$("#popupAnchor").val().trim())alert("点击图片跳转页面的url或锚点不能为空");else{var a=["url","锚点"],n=$('<div class="link link-popup"><p>图片：<span class="pop-img-url">'+$("#popupImgUrl").val()+"</span></p><p><span class='link-type'>"+a[$("[name='popType']:checked").data("value")]+"</span>：<span class='link-url'>"+$("#popupAnchor").val()+'</span></p><i class="close-link-btn">×</i></div>').appendTo(i);n.resizable({containment:i}).draggable({containment:i})}}),$(".img-wrapper").on("click","li img",function(){$(this).addClass("chosen");var i=$(this).attr("src"),a=$(CANVAS_PANEL).find(".cur");if(a.length>0){a.attr("chosenimg",i);var n=$("form:visible");n.find("[form-img]").val(i);var e=n.serializeObject();resetForm(e)}});