!function(){function e(e){var t=$("#"+e+"_from_date").val().trim(),n=$("#"+e+"_to_date").val().trim(),r={start:t,end:n};return console.log(moment(t).isBefore(n)),r.result=""==t||""==n?!0:t==n?!0:moment(n).isBefore(t)?!1:!0,r}var t=function(e){laydate({elem:"#"+e+"_from_date",format:"YYYY-MM-DD hh:mm:ss",istime:!0,istoday:!0,choose:function(e){console.log(e)}});var t=!!$("#"+e+"_from_date").val();laydate({elem:"＃"+e+"_to_date",format:t?"YYYY-MM-DD hh:mm:ss":"YYYY-MM-DD 23:59:59",istime:!0,istoday:!0,choose:function(){console.log(arguments),t?void 0:this.format="YYYY-MM-DD hh:mm:ss"}})};t("rule"),t("preference"),t("promotion");var n=function(){return"nextElementSibling"in HTMLHtmlElement.prototype?function(e){return e.nextElementSibling}:function(e){for(var t=e.nextSibling;t&&1!==t.nodeType;)t=t.nextSibling;return t}}();$(".search").click(function(){var t=this.getAttribute("name"),r=document.getElementById(t+"_id"),o=this.parentElement,i=o.getElementsByTagName("p")[0];if(""!==r.value.trim()){var a={};if(a[t+"Id"]=r.value.trim(),"order"!==t){var l=e(t);if(!l.result){var m=document.createElement("p");return m.style.color="red",m.style.marginBottom=0,m.innerHTML="结束时间要大于开始时间",void o.appendChild(m)}a.start=l.start,a.end=l.end,l=null}i&&o.removeChild(i),$.ajax({url:"/api/internal/sas/coupon/"+t,dataType:"json",data:a,success:function(e){var r=n(o),i=r.tHead,a=i.rows[0].cells,l=r.tBodies[0];l.innerHTML=null;var m=document.createElement("tr"),d=null,e=e.data;if("order"!==t?d=[t+"Id","commitCount","useCount"]:(d=["orderId","preferenceIds","promotionId","couponId","couponCode"],e=e[0]),"rule"===t&&d.splice(1,0,"bindCount"),e)for(var s=0,c=a.length;c>s;s++){var u=document.createElement("td");u.innerHTML=e[d[s]],m.appendChild(u)}else m.innerHTML="没有该订单号";l.appendChild(m)},error:function(e){console.log(e)}})}else if(!i){var m=document.createElement("p"),d={rule:"优惠券ID",preference:"直减ID",promotion:"仓减ID",order:"订单号"};m.style.color="red",m.style.marginBottom=0,m.innerHTML=d[t]+"不能为空",o.appendChild(m)}})}();